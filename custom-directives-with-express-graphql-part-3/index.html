<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.d6ce8ea94c612c002b96.css" data-identity="gatsby-global-css">.gatsby-highlight pre[class*=language-]{overflow:auto}.gatsby-highlight pre[class*=language-]:before{background:#000;border-radius:0 0 .25rem .25rem;color:#fff;font-size:12px;letter-spacing:.025rem;padding:.1rem .5rem;position:absolute;right:1rem;text-align:right;text-transform:uppercase;top:0}.gatsby-highlight pre[class=language-js]:before{background:#f7df1e;color:#000;content:"js"}th{border-bottom:1px solid #a00}td,th{padding:5px}blockquote{background:#f3f3f3;border-left:8px solid #010058;color:#555;font-style:italic;line-height:1.6;margin:auto 0;padding:1.2em 30px 1.2em 75px;position:relative}blockquote:before{color:#010058;content:"\201C";font-family:Arial;font-size:4em;left:10px;position:absolute;top:-10px}blockquote:after{content:""}blockquote span{color:#333;display:block;font-style:normal;font-weight:700;margin-top:1em}.gatsby-highlight{-webkit-overflow-scrolling:touch;position:relative}.gatsby-highlight pre[class*=language-]{-webkit-overflow-scrolling:touch;background:#000;border-radius:.25rem;color:#fff;font-size:15px;letter-spacing:.025rem;padding:25px .5rem .5rem}.language{border-radius:5px;bottom:5px;color:#c8ff00;font-size:11px;font-style:bold;letter-spacing:.05rem;padding:0 6px;position:absolute;right:2px;text-align:right}.my-masonry-grid{display:flex;margin-left:-20px;width:auto}.my-masonry-grid_column{background-clip:padding-box;padding-left:20px}.my-masonry-grid_column>div{margin-bottom:30px}</style><meta name="generator" content="Gatsby 3.7.1"/><link href="https://fonts.googleapis.com/css?family=Montserrat+Semi-bold|Merriweather|Roboto+Mono&amp;display=swap" rel="stylesheet"/><style id="jss-server-side">.MuiButtonBase-root{color:inherit;border:0;cursor:pointer;margin:0;display:inline-flex;outline:0;padding:0;position:relative;align-items:center;-webkit-user-select:none;-ms-user-select:none;user-select:none;border-radius:0;vertical-align:middle;-moz-appearance:none;justify-content:center;text-decoration:none;background-color:transparent;-webkit-appearance:none;-webkit-tap-highlight-color:transparent}.MuiButtonBase-root::-moz-focus-inner{border-style:none}.MuiButtonBase-root.Mui-disabled{cursor:default;pointer-events:none}@media print{.MuiButtonBase-root{-webkit-print-color-adjust:exact;color-adjust:exact}}.MuiButton-root{color:rgba(0,0,0,.87);padding:6px 16px;font-size:.875rem;min-width:64px;box-sizing:border-box;transition:background-color 250ms cubic-bezier(.4, 0, .2, 1) 0s,box-shadow 250ms cubic-bezier(.4, 0, .2, 1) 0s,border 250ms cubic-bezier(.4, 0, .2, 1) 0s;font-family:Merriweather,serif;font-weight:500;line-height:1.75;border-radius:4px;text-transform:uppercase}.MuiButton-root:hover{text-decoration:none;background-color:rgba(0,0,0,.04)}.MuiButton-root.Mui-disabled{color:rgba(0,0,0,.26)}@media (hover:none){.MuiButton-root:hover{background-color:transparent}}.MuiButton-root:hover.Mui-disabled{background-color:transparent}.MuiButton-label{width:100%;display:inherit;align-items:inherit;justify-content:inherit}.MuiButton-text{padding:6px 8px}.MuiButton-textPrimary{color:#3f51b5}.MuiButton-textPrimary:hover{background-color:rgba(63,81,181,.04)}@media (hover:none){.MuiButton-textPrimary:hover{background-color:transparent}}.MuiButton-textSecondary{color:#f50057}.MuiButton-textSecondary:hover{background-color:rgba(245,0,87,.04)}@media (hover:none){.MuiButton-textSecondary:hover{background-color:transparent}}.MuiButton-outlined{border:1px solid rgba(0,0,0,.23);padding:5px 15px}.MuiButton-outlined.Mui-disabled{border:1px solid rgba(0,0,0,.12)}.MuiButton-outlinedPrimary{color:#3f51b5;border:1px solid rgba(63,81,181,.5)}.MuiButton-outlinedPrimary:hover{border:1px solid #3f51b5;background-color:rgba(63,81,181,.04)}@media (hover:none){.MuiButton-outlinedPrimary:hover{background-color:transparent}}.MuiButton-outlinedSecondary{color:#f50057;border:1px solid rgba(245,0,87,.5)}.MuiButton-outlinedSecondary:hover{border:1px solid #f50057;background-color:rgba(245,0,87,.04)}.MuiButton-outlinedSecondary.Mui-disabled{border:1px solid rgba(0,0,0,.26)}@media (hover:none){.MuiButton-outlinedSecondary:hover{background-color:transparent}}.MuiButton-contained{color:rgba(0,0,0,.87);box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);background-color:#e0e0e0}.MuiButton-contained:hover{box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12);background-color:#d5d5d5}.MuiButton-contained.Mui-focusVisible{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.MuiButton-contained:active{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.MuiButton-contained.Mui-disabled{color:rgba(0,0,0,.26);box-shadow:none;background-color:rgba(0,0,0,.12)}@media (hover:none){.MuiButton-contained:hover{box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);background-color:#e0e0e0}}.MuiButton-contained:hover.Mui-disabled{background-color:rgba(0,0,0,.12)}.MuiButton-containedPrimary{color:#fff;background-color:#3f51b5}.MuiButton-containedPrimary:hover{background-color:#303f9f}@media (hover:none){.MuiButton-containedPrimary:hover{background-color:#3f51b5}}.MuiButton-containedSecondary{color:#fff;background-color:#f50057}.MuiButton-containedSecondary:hover{background-color:#c51162}@media (hover:none){.MuiButton-containedSecondary:hover{background-color:#f50057}}.MuiButton-disableElevation{box-shadow:none}.MuiButton-disableElevation:hover{box-shadow:none}.MuiButton-disableElevation.Mui-focusVisible{box-shadow:none}.MuiButton-disableElevation:active{box-shadow:none}.MuiButton-disableElevation.Mui-disabled{box-shadow:none}.MuiButton-colorInherit{color:inherit;border-color:currentColor}.MuiButton-textSizeSmall{padding:4px 5px;font-size:.8125rem}.MuiButton-textSizeLarge{padding:8px 11px;font-size:.9375rem}.MuiButton-outlinedSizeSmall{padding:3px 9px;font-size:.8125rem}.MuiButton-outlinedSizeLarge{padding:7px 21px;font-size:.9375rem}.MuiButton-containedSizeSmall{padding:4px 10px;font-size:.8125rem}.MuiButton-containedSizeLarge{padding:8px 22px;font-size:.9375rem}.MuiButton-fullWidth{width:100%}.MuiButton-startIcon{display:inherit;margin-left:-4px;margin-right:8px}.MuiButton-startIcon.MuiButton-iconSizeSmall{margin-left:-2px}.MuiButton-endIcon{display:inherit;margin-left:8px;margin-right:-4px}.MuiButton-endIcon.MuiButton-iconSizeSmall{margin-right:-2px}.MuiButton-iconSizeSmall>:first-child{font-size:18px}.MuiButton-iconSizeMedium>:first-child{font-size:20px}.MuiButton-iconSizeLarge>:first-child{font-size:22px}.MuiPaper-root{color:rgba(0,0,0,.87);transition:box-shadow .3s cubic-bezier(.4, 0, .2, 1) 0s;background-color:#fff}.MuiPaper-rounded{border-radius:4px}.MuiPaper-outlined{border:1px solid rgba(0,0,0,.12)}.MuiPaper-elevation0{box-shadow:none}.MuiPaper-elevation1{box-shadow:0 2px 1px -1px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 1px 3px 0 rgba(0,0,0,.12)}.MuiPaper-elevation2{box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.MuiPaper-elevation3{box-shadow:0 3px 3px -2px rgba(0,0,0,.2),0 3px 4px 0 rgba(0,0,0,.14),0 1px 8px 0 rgba(0,0,0,.12)}.MuiPaper-elevation4{box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)}.MuiPaper-elevation5{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 5px 8px 0 rgba(0,0,0,.14),0 1px 14px 0 rgba(0,0,0,.12)}.MuiPaper-elevation6{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.MuiPaper-elevation7{box-shadow:0 4px 5px -2px rgba(0,0,0,.2),0 7px 10px 1px rgba(0,0,0,.14),0 2px 16px 1px rgba(0,0,0,.12)}.MuiPaper-elevation8{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.MuiPaper-elevation9{box-shadow:0 5px 6px -3px rgba(0,0,0,.2),0 9px 12px 1px rgba(0,0,0,.14),0 3px 16px 2px rgba(0,0,0,.12)}.MuiPaper-elevation10{box-shadow:0 6px 6px -3px rgba(0,0,0,.2),0 10px 14px 1px rgba(0,0,0,.14),0 4px 18px 3px rgba(0,0,0,.12)}.MuiPaper-elevation11{box-shadow:0 6px 7px -4px rgba(0,0,0,.2),0 11px 15px 1px rgba(0,0,0,.14),0 4px 20px 3px rgba(0,0,0,.12)}.MuiPaper-elevation12{box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 12px 17px 2px rgba(0,0,0,.14),0 5px 22px 4px rgba(0,0,0,.12)}.MuiPaper-elevation13{box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 13px 19px 2px rgba(0,0,0,.14),0 5px 24px 4px rgba(0,0,0,.12)}.MuiPaper-elevation14{box-shadow:0 7px 9px -4px rgba(0,0,0,.2),0 14px 21px 2px rgba(0,0,0,.14),0 5px 26px 4px rgba(0,0,0,.12)}.MuiPaper-elevation15{box-shadow:0 8px 9px -5px rgba(0,0,0,.2),0 15px 22px 2px rgba(0,0,0,.14),0 6px 28px 5px rgba(0,0,0,.12)}.MuiPaper-elevation16{box-shadow:0 8px 10px -5px rgba(0,0,0,.2),0 16px 24px 2px rgba(0,0,0,.14),0 6px 30px 5px rgba(0,0,0,.12)}.MuiPaper-elevation17{box-shadow:0 8px 11px -5px rgba(0,0,0,.2),0 17px 26px 2px rgba(0,0,0,.14),0 6px 32px 5px rgba(0,0,0,.12)}.MuiPaper-elevation18{box-shadow:0 9px 11px -5px rgba(0,0,0,.2),0 18px 28px 2px rgba(0,0,0,.14),0 7px 34px 6px rgba(0,0,0,.12)}.MuiPaper-elevation19{box-shadow:0 9px 12px -6px rgba(0,0,0,.2),0 19px 29px 2px rgba(0,0,0,.14),0 7px 36px 6px rgba(0,0,0,.12)}.MuiPaper-elevation20{box-shadow:0 10px 13px -6px rgba(0,0,0,.2),0 20px 31px 3px rgba(0,0,0,.14),0 8px 38px 7px rgba(0,0,0,.12)}.MuiPaper-elevation21{box-shadow:0 10px 13px -6px rgba(0,0,0,.2),0 21px 33px 3px rgba(0,0,0,.14),0 8px 40px 7px rgba(0,0,0,.12)}.MuiPaper-elevation22{box-shadow:0 10px 14px -6px rgba(0,0,0,.2),0 22px 35px 3px rgba(0,0,0,.14),0 8px 42px 7px rgba(0,0,0,.12)}.MuiPaper-elevation23{box-shadow:0 11px 14px -7px rgba(0,0,0,.2),0 23px 36px 3px rgba(0,0,0,.14),0 9px 44px 8px rgba(0,0,0,.12)}.MuiPaper-elevation24{box-shadow:0 11px 15px -7px rgba(0,0,0,.2),0 24px 38px 3px rgba(0,0,0,.14),0 9px 46px 8px rgba(0,0,0,.12)}.jss7{display:flex;align-items:center}.jss14{display:flex;margin-top:50px;align-items:center;flex-direction:column;justify-content:center}.MuiGrid-container{width:100%;display:flex;flex-wrap:wrap;box-sizing:border-box}.MuiGrid-item{margin:0;box-sizing:border-box}.MuiGrid-zeroMinWidth{min-width:0}.MuiGrid-direction-xs-column{flex-direction:column}.MuiGrid-direction-xs-column-reverse{flex-direction:column-reverse}.MuiGrid-direction-xs-row-reverse{flex-direction:row-reverse}.MuiGrid-wrap-xs-nowrap{flex-wrap:nowrap}.MuiGrid-wrap-xs-wrap-reverse{flex-wrap:wrap-reverse}.MuiGrid-align-items-xs-center{align-items:center}.MuiGrid-align-items-xs-flex-start{align-items:flex-start}.MuiGrid-align-items-xs-flex-end{align-items:flex-end}.MuiGrid-align-items-xs-baseline{align-items:baseline}.MuiGrid-align-content-xs-center{align-content:center}.MuiGrid-align-content-xs-flex-start{align-content:flex-start}.MuiGrid-align-content-xs-flex-end{align-content:flex-end}.MuiGrid-align-content-xs-space-between{align-content:space-between}.MuiGrid-align-content-xs-space-around{align-content:space-around}.MuiGrid-justify-xs-center{justify-content:center}.MuiGrid-justify-xs-flex-end{justify-content:flex-end}.MuiGrid-justify-xs-space-between{justify-content:space-between}.MuiGrid-justify-xs-space-around{justify-content:space-around}.MuiGrid-justify-xs-space-evenly{justify-content:space-evenly}.MuiGrid-spacing-xs-1{width:calc(100% + 8px);margin:-4px}.MuiGrid-spacing-xs-1>.MuiGrid-item{padding:4px}.MuiGrid-spacing-xs-2{width:calc(100% + 16px);margin:-8px}.MuiGrid-spacing-xs-2>.MuiGrid-item{padding:8px}.MuiGrid-spacing-xs-3{width:calc(100% + 24px);margin:-12px}.MuiGrid-spacing-xs-3>.MuiGrid-item{padding:12px}.MuiGrid-spacing-xs-4{width:calc(100% + 32px);margin:-16px}.MuiGrid-spacing-xs-4>.MuiGrid-item{padding:16px}.MuiGrid-spacing-xs-5{width:calc(100% + 40px);margin:-20px}.MuiGrid-spacing-xs-5>.MuiGrid-item{padding:20px}.MuiGrid-spacing-xs-6{width:calc(100% + 48px);margin:-24px}.MuiGrid-spacing-xs-6>.MuiGrid-item{padding:24px}.MuiGrid-spacing-xs-7{width:calc(100% + 56px);margin:-28px}.MuiGrid-spacing-xs-7>.MuiGrid-item{padding:28px}.MuiGrid-spacing-xs-8{width:calc(100% + 64px);margin:-32px}.MuiGrid-spacing-xs-8>.MuiGrid-item{padding:32px}.MuiGrid-spacing-xs-9{width:calc(100% + 72px);margin:-36px}.MuiGrid-spacing-xs-9>.MuiGrid-item{padding:36px}.MuiGrid-spacing-xs-10{width:calc(100% + 80px);margin:-40px}.MuiGrid-spacing-xs-10>.MuiGrid-item{padding:40px}.MuiGrid-grid-xs-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-xs-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-xs-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-xs-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-xs-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-xs-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-xs-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-xs-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-xs-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-xs-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-xs-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-xs-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-xs-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-xs-12{flex-grow:0;max-width:100%;flex-basis:100%}@media (min-width:600px){.MuiGrid-grid-sm-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-sm-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-sm-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-sm-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-sm-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-sm-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-sm-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-sm-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-sm-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-sm-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-sm-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-sm-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-sm-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-sm-12{flex-grow:0;max-width:100%;flex-basis:100%}}@media (min-width:960px){.MuiGrid-grid-md-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-md-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-md-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-md-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-md-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-md-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-md-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-md-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-md-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-md-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-md-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-md-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-md-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-md-12{flex-grow:0;max-width:100%;flex-basis:100%}}@media (min-width:1280px){.MuiGrid-grid-lg-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-lg-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-lg-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-lg-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-lg-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-lg-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-lg-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-lg-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-lg-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-lg-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-lg-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-lg-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-lg-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-lg-12{flex-grow:0;max-width:100%;flex-basis:100%}}@media (min-width:1920px){.MuiGrid-grid-xl-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-xl-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-xl-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-xl-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-xl-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-xl-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-xl-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-xl-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-xl-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-xl-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-xl-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-xl-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-xl-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-xl-12{flex-grow:0;max-width:100%;flex-basis:100%}}.MuiTypography-root{margin:0}.MuiTypography-body2{font-size:.875rem;font-family:Merriweather,sans-serif;font-weight:400;line-height:1.43}.MuiTypography-body1{font-size:1rem;font-family:Merriweather,sans-serif;font-weight:400;line-height:1.5}.MuiTypography-caption{font-size:.75rem;font-family:Merriweather,serif;font-weight:400;line-height:1.66}.MuiTypography-button{font-size:.875rem;font-family:Merriweather,serif;font-weight:500;line-height:1.75;text-transform:uppercase}.MuiTypography-h1{font-size:6rem;font-family:Montserrat,sans-serif;font-weight:300;line-height:1.167}.MuiTypography-h2{font-size:3.75rem;font-family:Montserrat,sans-serif;font-weight:300;line-height:1.2}.MuiTypography-h3{font-size:3rem;font-family:Montserrat,sans-serif;font-weight:400;line-height:1.167}.MuiTypography-h4{font-size:2.125rem;font-family:Montserrat,sans-serif;font-weight:400;line-height:1.235}.MuiTypography-h5{font-size:1.5rem;font-family:Montserrat,sans-serif;font-weight:700;line-height:1.334}.MuiTypography-h6{font-size:1.25rem;font-family:Montserrat,sans-serif;font-weight:700;line-height:1.6}.MuiTypography-subtitle1{font-size:1rem;font-family:Merriweather,serif;font-weight:400;line-height:1.75}.MuiTypography-subtitle2{color:#f57;font-size:.875rem;font-style:italic;font-family:Merriweather,serif;font-weight:700;line-height:1.57}.MuiTypography-overline{font-size:.75rem;font-family:Merriweather,serif;font-weight:400;line-height:2.66;text-transform:uppercase}.MuiTypography-srOnly{width:1px;height:1px;overflow:hidden;position:absolute}.MuiTypography-alignLeft{text-align:left}.MuiTypography-alignCenter{text-align:center}.MuiTypography-alignRight{text-align:right}.MuiTypography-alignJustify{text-align:justify}.MuiTypography-noWrap{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.MuiTypography-gutterBottom{margin-bottom:.35em}.MuiTypography-paragraph{margin-bottom:16px}.MuiTypography-colorInherit{color:inherit}.MuiTypography-colorPrimary{color:#3f51b5}.MuiTypography-colorSecondary{color:#f50057}.MuiTypography-colorTextPrimary{color:rgba(0,0,0,.87)}.MuiTypography-colorTextSecondary{color:rgba(0,0,0,.54)}.MuiTypography-colorError{color:#f44336}.MuiTypography-displayInline{display:inline}.MuiTypography-displayBlock{display:block}.MuiToolbar-root{display:flex;position:relative;align-items:center}.MuiToolbar-gutters{padding-left:16px;padding-right:16px}@media (min-width:600px){.MuiToolbar-gutters{padding-left:24px;padding-right:24px}}.MuiToolbar-regular{min-height:56px}@media (min-width:0px) and (orientation:landscape){.MuiToolbar-regular{min-height:48px}}@media (min-width:600px){.MuiToolbar-regular{min-height:64px}}.MuiToolbar-dense{min-height:48px}.MuiLink-underlineNone{text-decoration:none}.MuiLink-underlineHover{text-decoration:none}.MuiLink-underlineHover:hover{text-decoration:underline}.MuiLink-underlineAlways{text-decoration:underline}.MuiLink-button{border:0;cursor:pointer;margin:0;outline:0;padding:0;position:relative;-webkit-user-select:none;-ms-user-select:none;user-select:none;border-radius:0;vertical-align:middle;-moz-appearance:none;background-color:transparent;-webkit-appearance:none;-webkit-tap-highlight-color:transparent}.MuiLink-button::-moz-focus-inner{border-style:none}.MuiLink-button.Mui-focusVisible{outline:auto}.MuiAppBar-root{width:100%;display:flex;z-index:1100;box-sizing:border-box;flex-shrink:0;flex-direction:column}.MuiAppBar-positionFixed{top:0;left:auto;right:0;position:fixed}@media print{.MuiAppBar-positionFixed{position:absolute}}.MuiAppBar-positionAbsolute{top:0;left:auto;right:0;position:absolute}.MuiAppBar-positionSticky{top:0;left:auto;right:0;position:-webkit-sticky;position:sticky}.MuiAppBar-positionStatic{position:static}.MuiAppBar-positionRelative{position:relative}.MuiAppBar-colorDefault{color:rgba(0,0,0,.87);background-color:#f5f5f5}.MuiAppBar-colorPrimary{color:#fff;background-color:#3f51b5}.MuiAppBar-colorSecondary{color:#fff;background-color:#f50057}.MuiAppBar-colorInherit{color:inherit}.MuiAppBar-colorTransparent{color:inherit;background-color:transparent}.jss2{padding-left:118px;margin-bottom:80px;padding-right:79px;background-color:#400ccc}@media (max-width:900px){.jss2{padding-left:0}}.jss3{color:#fffefe;text-align:left;font-family:Work Sans,sans-serif;font-weight:600}.jss4{size:18px;font-weight:700;margin-left:38px}.jss5{display:flex;justify-content:space-between}.jss6{padding:20px 30px}.jss1{margin:20px 0;flex-grow:1}@media (min-width:1280px){.jss8{top:32vh;right:5rem;width:15rem;position:fixed;max-width:15rem}}@media (min-width:1920px){.jss8{top:32vh;right:3rem;width:15rem;position:fixed;max-width:15rem}}.jss9{max-height:350px;overflow-y:auto;margin-left:0}.jss10{padding:0}.jss11{color:inherit}.jss12{font-style:inherit;font-weight:700}</style><title data-react-helmet="true">Custom directives with express-graphql [Part-3]</title><meta data-react-helmet="true" name="google-site-verification" content="71cWx1ID2lznPcYeaPWglNrACVAeqXAlXleUcm4_5HE"/><meta data-react-helmet="true" name="description" content="Adding custom directives using express-graphql and graphql-directive."/><meta data-react-helmet="true" name="og:title" content="Custom directives with express-graphql [Part-3]"/><meta data-react-helmet="true" name="og:description" content="Adding custom directives using express-graphql and graphql-directive."/><meta data-react-helmet="true" name="og:type" content="website"/><meta data-react-helmet="true" property="og:image" content="/static/1b289d874439805d34eead0c1756920b/feature.jpg"/><meta data-react-helmet="true" property="og:url"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="pineapple45"/><meta data-react-helmet="true" name="twitter:title" content="Custom directives with express-graphql [Part-3]"/><meta data-react-helmet="true" name="twitter:description" content="Adding custom directives using express-graphql and graphql-directive."/><meta data-react-helmet="true" name="twitter:image" content="/static/1b289d874439805d34eead0c1756920b/feature.jpg"/><meta data-react-helmet="true" name="keywords" content="gatsby-blog, web-devlopement-&amp;-machine-&amp;-deep-learning-blog, static-website, mdx-gatsby-blog"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/webpack-runtime-7db009d6acd8d3eb2c1f.js"/><link as="script" rel="preload" href="/framework-8b3c321ae27fc20a6b24.js"/><link as="script" rel="preload" href="/app-4e1f042b2ddf33033244.js"/><link as="script" rel="preload" href="/commons-be761d1874bc4e647fc8.js"/><link as="script" rel="preload" href="/72f02af15790646481057260ef855e91d01147d0-96b483a23b69f0de04e6.js"/><link as="script" rel="preload" href="/0684c67b9e8324955648f07f379967749028407c-e3e25b0e30fb34667ff0.js"/><link as="script" rel="preload" href="/component---src-templates-single-post-js-b1a90b0d8e8cbfe3f272.js"/><link as="fetch" rel="preload" href="/page-data/custom-directives-with-express-graphql-part-3/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2933417362.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3079204723.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="jss1"><div class="MuiGrid-root MuiGrid-container MuiGrid-justify-xs-center"><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-11 MuiGrid-grid-sm-10 MuiGrid-grid-md-8"><header class="jss2"><header class="MuiPaper-root MuiAppBar-root MuiAppBar-positionFixed MuiAppBar-colorPrimary mui-fixed MuiPaper-elevation4"><div class="MuiToolbar-root MuiToolbar-regular jss5 MuiToolbar-gutters"><div class="MuiBox-root jss7" style="cursor:pointer"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTE0MCIgaGVpZ2h0PSIxMTQwIiB2aWV3Qm94PSIwIDAgMTE0MCAxMTQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8Y2lyY2xlIGN4PSI1NzAiIGN5PSI1NzAiIHI9IjU3MCIgZmlsbD0iIzIxMDAzQSIvPgo8cGF0aCBkPSJNMzk3LjQ3MSA4OTQuMzc1TDU0NS4zNTMgODA5LjYyNVY2NzEuMDIzTDM5Ny40NzEgNzQzLjQxNFY4OTQuMzc1Wk0zNzIuODI0IDY5My45NzdMNTI4LjQwOCA2MTcuNjEzTDM3Mi44MjQgNTQxLjI1TDIxNy4yMzkgNjE3LjYxM0wzNzIuODI0IDY5My45NzdaTTc5MS44MjQgODk0LjM3NUw5MzkuNzA2IDgwOS42MjVWNjcxLjAyM0w3OTEuODI0IDc0My40MTRWODk0LjM3NVpNNzY3LjE3NiA2OTMuOTc3TDkyMi43NjEgNjE3LjYxM0w3NjcuMTc2IDU0MS4yNUw2MTEuNTkyIDYxNy42MTNMNzY3LjE3NiA2OTMuOTc3Wk01OTQuNjQ3IDU2NC42NDVMNzQyLjUyOSA0OTEuODEyVjM3NC4zOThMNTk0LjY0NyA0NDYuNzg5VjU2NC42NDVaTTU3MCAzOTcuMzUyTDczOS44MzQgMzEzLjkyNkw1NzAgMjMwLjVMNDAwLjE2NiAzMTMuOTI2TDU3MCAzOTcuMzUyWk05ODkgNjI2VjgwOS42MjVDOTg5IDgyMC4yMTkgOTg2LjU2MSA4MzAuMDc3IDk4MS42ODMgODM5LjE5OUM5NzYuODA1IDg0OC4zMjIgOTcwLjEzIDg1NS4yMzcgOTYxLjY1NyA4NTkuOTQ1TDc4OS4xMjggOTU4LjgyQzc4Mi43MDkgOTYyLjk0IDc3NS4zOTIgOTY1IDc2Ny4xNzYgOTY1Qzc1OC45NjEgOTY1IDc1MS42NDQgOTYyLjk0IDc0NS4yMjUgOTU4LjgyTDU3Mi42OTYgODU5Ljk0NUM1NzEuNjY5IDg1OS4zNTcgNTcwLjc3IDg1OC43NjggNTcwIDg1OC4xOEM1NjkuNDg3IDg1OC43NjggNTY4LjU4OCA4NTkuMzU3IDU2Ny4zMDQgODU5Ljk0NUwzOTQuNzc1IDk1OC44MkMzODguMzU2IDk2Mi45NCAzODEuMDM5IDk2NSAzNzIuODI0IDk2NUMzNjQuNjA4IDk2NSAzNTcuMjkxIDk2Mi45NCAzNTAuODcyIDk1OC44MkwxNzguMzQzIDg1OS45NDVDMTY5Ljg3IDg1NS4yMzcgMTYzLjE5NSA4NDguMzIyIDE1OC4zMTcgODM5LjE5OUMxNTMuNDM5IDgzMC4wNzcgMTUxIDgyMC4yMTkgMTUxIDgwOS42MjVWNjI2QzE1MSA2MTQuODE4IDE1My43NiA2MDQuNTE4IDE1OS4yOCA1OTUuMTAyQzE2NC44IDU4NS42ODUgMTcyLjA1MyA1NzguNjIyIDE4MS4wMzkgNTczLjkxNEwzNDguMTc2IDQ5MS44MTJWMzE1LjI1QzM0OC4xNzYgMzA0LjA2OCAzNTAuOTM2IDI5My43NjggMzU2LjQ1NiAyODQuMzUyQzM2MS45NzYgMjc0LjkzNSAzNjkuMjI5IDI2Ny44NzIgMzc4LjIxNSAyNjMuMTY0TDU1MC43NDQgMTc4LjQxNEM1NTYuNjUgMTc1LjQ3MSA1NjMuMDY4IDE3NCA1NzAgMTc0QzU3Ni45MzIgMTc0IDU4My4zNSAxNzUuNDcxIDU4OS4yNTYgMTc4LjQxNEw3NjEuNzg1IDI2My4xNjRDNzcwLjc3MSAyNjcuODcyIDc3OC4wMjQgMjc0LjkzNSA3ODMuNTQ0IDI4NC4zNTJDNzg5LjA2NCAyOTMuNzY4IDc5MS44MjQgMzA0LjA2OCA3OTEuODI0IDMxNS4yNVY0OTEuODEyTDk1OC45NjEgNTczLjkxNEM5NjguMjA0IDU3OC42MjIgOTc1LjUyMSA1ODUuNjg1IDk4MC45MTMgNTk1LjEwMkM5ODYuMzA0IDYwNC41MTggOTg5IDYxNC44MTggOTg5IDYyNloiIGZpbGw9IiNGRjU1NzciLz4KPC9zdmc+Cg==" alt="brand-icon" width="50px" style="margin-right:20px"/><h5 class="MuiTypography-root MuiTypography-h5">ShadedVoxels</h5></div><div><a class="MuiButtonBase-root MuiButton-root MuiButton-text jss4 MuiButton-colorInherit" tabindex="0" role="button" aria-disabled="false" href="/"><span class="MuiButton-label">Home</span></a><a class="MuiButtonBase-root MuiButton-root MuiButton-text jss4 MuiButton-colorInherit" tabindex="0" role="button" aria-disabled="false" href="/projects"><span class="MuiButton-label">Projects</span></a><a class="MuiButtonBase-root MuiButton-root MuiButton-text jss4 MuiButton-colorInherit" tabindex="0" role="button" aria-disabled="false" href="/about"><span class="MuiButton-label">About</span></a></div></div></header></header></div><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-11 MuiGrid-grid-sm-10 MuiGrid-grid-md-7"><h5 class="MuiTypography-root MuiTypography-h5">Custom directives with express-graphql [Part-3]</h5><p class="MuiTypography-root MuiTypography-subtitle1">Adding custom directives using express-graphql and graphql-directive.</p><h6 class="MuiTypography-root MuiTypography-subtitle2" style="text-align:right">Posted on: <!-- -->29-06-2021</h6><br/><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden"><div aria-hidden="true" style="width:100%;padding-bottom:65%"></div><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABy6yMRiD/xAAZEAACAwEAAAAAAAAAAAAAAAAAAgERICH/2gAIAQEAAQUCGSieY//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABgQAAIDAAAAAAAAAAAAAAAAAAABESAi/9oACAEBAAY/AhaTmv8A/8QAGhABAAEFAAAAAAAAAAAAAAAAEQABICFBUf/aAAgBAQABPyEnDBxqUIs//9oADAMBAAIAAwAAABDAD//EABYRAAMAAAAAAAAAAAAAAAAAAAEQYf/aAAgBAwEBPxAxf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQEAAQUAAAAAAAAAAAAAAAERACAxQXGR/9oACAEBAAE/ECi0O8MztsvDl2hnJo//2Q==" alt="3154c12d-0b7e-5881-bc9e-5282f9ca9468" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/1b289d874439805d34eead0c1756920b/f836f/feature.jpg 200w,
/static/1b289d874439805d34eead0c1756920b/2244e/feature.jpg 400w,
/static/1b289d874439805d34eead0c1756920b/14b42/feature.jpg 800w,
/static/1b289d874439805d34eead0c1756920b/47498/feature.jpg 1200w,
/static/1b289d874439805d34eead0c1756920b/0e329/feature.jpg 1600w,
/static/1b289d874439805d34eead0c1756920b/ee1b0/feature.jpg 1721w" sizes="(max-width: 800px) 100vw, 800px" /><img loading="lazy" sizes="(max-width: 800px) 100vw, 800px" srcset="/static/1b289d874439805d34eead0c1756920b/f836f/feature.jpg 200w,
/static/1b289d874439805d34eead0c1756920b/2244e/feature.jpg 400w,
/static/1b289d874439805d34eead0c1756920b/14b42/feature.jpg 800w,
/static/1b289d874439805d34eead0c1756920b/47498/feature.jpg 1200w,
/static/1b289d874439805d34eead0c1756920b/0e329/feature.jpg 1600w,
/static/1b289d874439805d34eead0c1756920b/ee1b0/feature.jpg 1721w" src="/static/1b289d874439805d34eead0c1756920b/14b42/feature.jpg" alt="3154c12d-0b7e-5881-bc9e-5282f9ca9468" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><br/><div class="MuiBox-root jss13 jss8"><h6 class="MuiTypography-root jss12 MuiTypography-h6">Table of contents</h6><hr/><ol class="jss9"><li disablegutters="true"><h4 class="MuiTypography-root MuiTypography-body1" style="padding:5px"><a class="jss11" href="/custom-directives-with-express-graphql-part-3/#choosing-a-wise-logic-for-authentication--authorisation">Choosing a wise logic for authentication &amp; authorisation</a></h4></li><li disablegutters="true"><h4 class="MuiTypography-root MuiTypography-body1" style="padding:5px"><a class="jss11" href="/custom-directives-with-express-graphql-part-3/#installing-graphql-directive-package">Installing graphql-directive package</a></h4></li><li disablegutters="true"><h4 class="MuiTypography-root MuiTypography-body1" style="padding:5px"><a class="jss11" href="/custom-directives-with-express-graphql-part-3/#adding-types-for-graphql-directive-package">Adding types for graphql-directive package</a></h4></li><li disablegutters="true"><h4 class="MuiTypography-root MuiTypography-body1" style="padding:5px"><a class="jss11" href="/custom-directives-with-express-graphql-part-3/#so-how-does-graphql-directive-package-works">So, how does graphql-directive package works?</a></h4></li><li disablegutters="true"><h4 class="MuiTypography-root MuiTypography-body1" style="padding:5px"><a class="jss11" href="/custom-directives-with-express-graphql-part-3/#adding-graphql-directive-resolvers">Adding graphql-directive resolvers</a></h4></li><li disablegutters="true"><h4 class="MuiTypography-root MuiTypography-body1" style="padding:5px"><a class="jss11" href="/custom-directives-with-express-graphql-part-3/#updating-graphql-schema-file-to-handle-custom-directives">Updating graphql-schema file to handle custom directives</a></h4></li><li disablegutters="true"><h4 class="MuiTypography-root MuiTypography-body1" style="padding:5px"><a class="jss11" href="/custom-directives-with-express-graphql-part-3/#updating-entry-srcindexts-file-to-pass-graphql-context-to-each-of-the-directive-resolvers">Updating entry src/index.ts file to pass graphql context to each of the directive-resolvers</a></h4></li><li disablegutters="true"><h4 class="MuiTypography-root MuiTypography-body1" style="padding:5px"><a class="jss11" href="/custom-directives-with-express-graphql-part-3/#splitting-our-graphql-schemaoptional">Splitting our graphql schema(optional)</a></h4></li><li disablegutters="true"><h4 class="MuiTypography-root MuiTypography-body1" style="padding:5px"><a class="jss11" href="/custom-directives-with-express-graphql-part-3/#updated-directory-structure-for-schemas-folder">Updated directory structure for schemas folder</a></h4></li><li disablegutters="true"><h4 class="MuiTypography-root MuiTypography-body1" style="padding:5px"><a class="jss11" href="/custom-directives-with-express-graphql-part-3/#react-app-frontend-setup">React App frontend setup</a></h4></li><li disablegutters="true"><h4 class="MuiTypography-root MuiTypography-body1" style="padding:5px"><a class="jss11" href="/custom-directives-with-express-graphql-part-3/#final-points">Final points</a></h4></li></ol></div><div class="MuiTypography-root MuiTypography-body1"><p>Till now we have the application structure fully setup. If you are directly coming over here to part 3 , I am assuming you have the base structure of your app completed, which includes setting up the express-graphql server , graphql-schema and corrosponding resolvers. If you haven&#x27;t I highly recommend checking out part-1 and part-2. Otherwise, let&#x27;s start!</p><p>📍 Final code: <a href="https://github.com/pineapple45/custom-directives-with-express-graphql/tree/main">Link</a></p><p>There are only 2 main things left:</p><ol><li>Authentication</li><li>Authorisation</li></ol><p>We will be using JWT authentication method for loging in the user.</p><h3 id="choosing-a-wise-logic-for-authentication--authorisation">Choosing a wise logic for authentication &amp; authorisation</h3><p>If you have worked with REST API, imo it is a bit easier to implement both of the functionalities. We can just create a middleware and apply the same middleware to each of the routes(<em>get</em> requests) that we either want to authenticate or on top of that authorize. But how will we implement that in graphql ? We have only a single
route <em>http://your-host-url/graphql</em>. We are left with 2 choices.</p><ol><li>Either attach a special property to each incoming request and then check in each of the resolver functions(users, posts, comments, likes etc) weather the resolver should fulfill the request or not!</li><li>Attatch custom resolver directly to each of our query , mutation or type definations in our graphql schema. Each custom resolver will have a seperate implementation logic where it will be checked weather the request should even reach the resolver or not?</li></ol><p>Now both the methods can be used. But personally I would prefer to go with second one. I think this is a good approach because this approach has quite a lot of benefits. The most visible ones are:</p><ol><li>Code becomes much more modular. Write less code with same functionality!</li><li>Attatching a special property to each incoming request and then check where request should be fullfilled or not inside the resolver is cumbersome. As you can imagine when projects become larger, the resolvers will also increase. Managing logic for authentication/authorisation becomes really tedious and it may happen that
you may forget adding this logic in some resolvers. The first approach is good enough for smaller projects.</li><li>Provides a REST like architecture. It kind of takes a middleware approach very similar to REST as you will see in a bit.</li></ol><h3 id="installing-graphql-directive-package">Installing graphql-directive package</h3><p>If you haven&#x27;t already, download the <a href="https://www.npmjs.com/package/graphql-directive">graphql-directive</a> package.</p><div class="gatsby-highlight" data-language="cmd"><pre class="prism-code language-cmd" style="color:#d6deeb;background-color:#011627"><span class="language" style="bottom:20px">cmd</span><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token plain">yarn add graphql-directive</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">// or</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">npm i graphql-directive</span></div></pre></div><p>👉 Please note the version number for &#x27;graphql&#x27; package and to specifically use <em>14.6.0</em> as I was having a couple of problems with newer version of graphql package.</p><h3 id="adding-types-for-graphql-directive-package">Adding types for graphql-directive package</h3><p>Since no type are available for graphql-directive package that we installed, we create a graphql-directive.d.ts file in the root with content as follows:</p><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627"><span class="language" style="bottom:20px">ts</span><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">declare</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">module</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;graphql-directive&quot;</span></div></pre></div><h3 id="so-how-does-graphql-directive-package-works">So, how does graphql-directive package works?</h3><p>To better understand take a carefull look at the following diagram:</p><p><undefined>
      <div class="gria-image-wrapper" style="position:relative;overflow:hidden">
      
        
          <div class="gria-image-padding" style="width:100%;padding-bottom:104.5%"></div>
        
        
      
      <div class="gria-image-placeholder" style="position:absolute;top:0;left:0;width:100%;height:100%;background:#fff url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC6ElEQVQ4y5WUC28aRxSF/f//SpU2jpKqSiVLaVLbaVrb2MUELGyzBNbAAvue3Xl90cyyFGo7Ua50tSPtnTPn3NeBtRalFMaYPddao7SmNRfXmpQSIQRVVXl357qufcyB+5nnOWVZUhSFD9ba+EcKUflvC+Yuu/NisWAwGDAcDr3f3Nwwm818zIFjoo3BGgOYlo+/qJVqmCrFcrnk6OiIJImZzWd0u116vR79fp/r62smk8kG0DQgeWUZRxV3YcrDWqGMxbjHNl5XNeE0xGiDVtqrccra71ayk+cY1cqyzhVRLEhKjXGAxmzzloiYMA4J5iMe1iHG6G0q2rgNYMPgP8kWbFOYJn9N8L/BFT//8YLDDy856R+jjdqCuLgtoHvEHZ7z1tbFmvE84MtiTJQu9qq/B8gTtgvmclbmgmSdIfIKayxFJojXKbJWXtE+Qx4zZAdQFIK/33X48+0n+p0hWmq6J32ufrtkNmyYtoC+yruyWjMWlLZoC6JSrFcZ8SojSQqf5bpQ1IlAVk1buQq7nG8lW11TTi7Jxx3vWXBOFlyg5z3ssg/rAYgZyegfks8n2GK+kWhI05QwDH37ONAGUAlW3d+ZnL3xPj17Q3j+K3HviPzmHXp0jElGVNMe8raDLSJsg+iB9c6IekAjS6Znrxm8/4nbk1+83388JPj0iruPh8Tdt1AuHhXu2Spbo0iCDsvbM5LROfn4wktu01BNrzBV+uSieBLQyJgyHVPlE2Sdejmt+yJUGcWyRxFdI8v59xmKVZcv3RdMP79ExAO0bqalnRJTRYjgmPLuAzK+3+lV/IjKzUbakVxjVOHdGolSGrvdO+zwfc7sN/rQgrYWuVhQXl5gROnDXSXdrqxr2Ui0lqxU3Icx99MV41lGWbdt878pcYr1Q0j11ykyTVHGIGVNkiREUeQXrVtt0yjnuBNwejni9GrMMq33Z7ll61Z/mSYsg8Bf/BF7BNjOdi0lpWOyU83vucvXV9YkWYt625jSAAAAAElFTkSuQmCC) center / cover no-repeat"></div>
    
    <picture>
      <source srcSet="/static/6d266ce8c382f3c74fa8da71c438c4c6/772e8/nqTdaeXTP.png 200w,/static/6d266ce8c382f3c74fa8da71c438c4c6/e17e5/nqTdaeXTP.png 400w,/static/6d266ce8c382f3c74fa8da71c438c4c6/5a190/nqTdaeXTP.png 800w,/static/6d266ce8c382f3c74fa8da71c438c4c6/c1b63/nqTdaeXTP.png 1200w,/static/6d266ce8c382f3c74fa8da71c438c4c6/10ab7/nqTdaeXTP.png 1552w"/>
      <img class="gria-image" src="/static/6d266ce8c382f3c74fa8da71c438c4c6/5a190/nqTdaeXTP.png" srcSet="/static/6d266ce8c382f3c74fa8da71c438c4c6/772e8/nqTdaeXTP.png 200w,/static/6d266ce8c382f3c74fa8da71c438c4c6/e17e5/nqTdaeXTP.png 400w,/static/6d266ce8c382f3c74fa8da71c438c4c6/5a190/nqTdaeXTP.png 800w,/static/6d266ce8c382f3c74fa8da71c438c4c6/c1b63/nqTdaeXTP.png 1200w,/static/6d266ce8c382f3c74fa8da71c438c4c6/10ab7/nqTdaeXTP.png 1552w" title="custom-directive-workflow.png" alt="custom-directive-workflow.png" loading="lazy" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center center"/>
    </picture>
  
      </div>
    </undefined></p><p>👉 I wanted to give you a heads up that we define the graphql context in the root index.ts file of our server where we initialize our graphql-server. We will also update our code to define the context in a little bit. To give you a preview how that will look, it would be like this:</p><div class="gatsby-highlight" data-language=""><pre class="prism-code language-" style="color:#d6deeb;background-color:#011627"><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token plain">app.use(&quot;/graphql&quot;, (req, res) =&gt; {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  return graphqlHTTP({</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    schema: schema,</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    rootValue: rootResolver,</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    graphiql: true,</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    context: { req, res }, // we pass context here which will be received by aur directive resolvers</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  })(req, res)</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">})</span></div></pre></div><h3 id="adding-graphql-directive-resolvers">Adding graphql-directive resolvers</h3><p>Folder structure for adding directives will be as follows:</p><div class="gatsby-highlight" data-language=""><pre class="prism-code language-" style="color:#d6deeb;background-color:#011627"><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token plain">-src</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">--graphql</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">---directives</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">----hasAuthorisation</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">----isAuthenticated</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">----upperCase</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">----index.ts</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">.</span></div></pre></div><p>Now we will implement resolvers for our custom directives</p><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627"><span class="language" style="bottom:20px">ts</span><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">/* hasAuthorisation */</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports">jwt</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;jsonwebtoken&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">hasAuthorisation</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  resolve</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  directiveArgs</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  obj</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  context</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  info</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> authHeader </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">req</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token keyword" style="color:rgb(127, 219, 202)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;authorization&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">authHeader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">authHeader </span><span class="token operator" style="color:rgb(127, 219, 202)">===</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">undefined</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">||</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">authHeader</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name" style="color:rgb(255, 203, 139)">Error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)">you are unauthenticated</span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> authHeader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">split</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot; &quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(127, 219, 202)">!</span><span class="token plain">token </span><span class="token operator" style="color:rgb(127, 219, 202)">||</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(127, 219, 202)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name" style="color:rgb(255, 203, 139)">Error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Token not found or has expired&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">let</span><span class="token plain"> decodedToken</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    decodedToken </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> jwt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">verify</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">JWT_SECRET_KEY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">as</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(127, 219, 202)">!</span><span class="token plain">token </span><span class="token operator" style="color:rgb(127, 219, 202)">||</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(127, 219, 202)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name" style="color:rgb(255, 203, 139)">Error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(127, 219, 202)">!</span><span class="token plain">decodedToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name" style="color:rgb(255, 203, 139)">Error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Token verification failed&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// check authorisation roles here</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> roleToCheckFrom </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> obj </span><span class="token operator" style="color:rgb(127, 219, 202)">&amp;&amp;</span><span class="token plain"> obj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">roles</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">roleToCheckFrom</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">indexOf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">decodedToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">role</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">===</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name" style="color:rgb(255, 203, 139)">Error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Not Authorised&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">resolve</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre></div><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627"><span class="language" style="bottom:20px">ts</span><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">/* isAuthenticated */</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports">jwt</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;jsonwebtoken&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">isAuthenticated</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  resolve</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  directiveArgs</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  obj</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  context</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  info</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// console.log(context.req);</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> authHeader </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">req</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token keyword" style="color:rgb(127, 219, 202)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Authorization&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">authHeader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">authHeader </span><span class="token operator" style="color:rgb(127, 219, 202)">===</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">undefined</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">||</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">authHeader</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name" style="color:rgb(255, 203, 139)">Error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)">you are unauthenticated</span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> authHeader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">split</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot; &quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(127, 219, 202)">!</span><span class="token plain">token </span><span class="token operator" style="color:rgb(127, 219, 202)">||</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(127, 219, 202)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name" style="color:rgb(255, 203, 139)">Error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Token not found or has expired&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">let</span><span class="token plain"> decodedToken</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    decodedToken </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> jwt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">verify</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">JWT_SECRET_KEY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">as</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(127, 219, 202)">!</span><span class="token plain">token </span><span class="token operator" style="color:rgb(127, 219, 202)">||</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(127, 219, 202)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name" style="color:rgb(255, 203, 139)">Error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(127, 219, 202)">!</span><span class="token plain">decodedToken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name" style="color:rgb(255, 203, 139)">Error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Token verification failed&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">resolve</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre></div><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627"><span class="language" style="bottom:20px">ts</span><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">/* upperCase */</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">upperCase</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  resolve</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  directiveArgs</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  obj</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  context</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  info</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">any</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> value </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">resolve</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 139)">String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">toUpperCase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre></div><p>In the above custom directive resolvers, we are creating an asynchronous function that takes 5 arguments:</p><ol><li>resolve</li><li>directiveArgs</li><li>obj</li><li>context</li><li>info</li></ol><p>So what do they all mean? I will copy a part of documentation written in the <a href="https://www.npmjs.com/package/graphql-directive">graphql-directive npm package</a> below that exactly describes what all of these mean. But what I would suggest is logging out each of these in your console to see what output each of them give.</p><ol><li><p><strong>resolve</strong>: Resolve is a function that returns the result of the directive field. For consistency, it always returns a promise resolved with the original field resolver.</p></li><li><p><strong>obj</strong>: The object that contains the result returned from the resolver on the parent field, or, in the case of a top-level Query field, the rootValue passed from the server configuration. This argument enables the nested nature of GraphQL queries.</p></li><li><p><strong>directiveArgs</strong>: An object with the arguments passed into the directive in the query or schema. For example, if the directive was called with @dateFormat(format: &quot;DD/MM/YYYY&quot;), the args object would be: { &quot;format&quot;: &quot;DD/MM/YYYY&quot; }.</p></li><li><p><strong>context</strong>: This is an object shared by all resolvers in a particular query, and is used to contain per-request state, including authentication information, <a href="https://github.com/graphql/dataloader">dataloader </a> instances, and anything else that should be taken into account when resolving the query.</p></li><li><p><strong>info</strong>: This argument should only be used in advanced cases, but it contains information about the execution state of the query, including the field name, path to the field from the root, and more. It’s only documented in the <a href="https://github.com/graphql/graphql-js/blob/c82ff68f52722c20f10da69c9e50a030a1f218ae/src/type/definition.js#L489-L500">GraphQL.js source code</a> .</p></li></ol><p>If you are not able to understand all of these arguments , then it&#x27;s all fine because we will be using only 3 of these which are <em>resolve </em>, <em>obj </em>and <em>context</em></p><p>In <em>upperCase </em>resolver we execute resolve() function and we receive the input value which needs to be converted into upperCase word.</p><p><em>context </em>argument is an object that has all the properties that we passed earlier from our root index.ts file.</p><p><em>obj </em>argument is an object that consists of all properties specified with the directive in our graphql schema. For eg. below in the schema where we declare our directives, with <em>@hasAuthorisation</em> directive , we use roles property as &#x27;@hasAuthorisation(roles: <!-- -->[ADMIN]<!-- -->)&#x27; where roles is an array and can consist of multiple roles to check from like ADMIN , MODERATOR etc. we can then access roles through <em>obj</em> argument like <em>obj.roles</em>!</p><p>👉 Note that <em>@hasAuthorisation</em> directive also covers the logic for <em>@isAuthenticated</em>. So while using the <em>@hasAuthorisation</em> directive, even if the user is the correctly authorised one, if user is not authenticated or as I should say the request header is empty with no Authorization token , graphql will give error message of <em>not authenticated!</em></p><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627"><span class="language" style="bottom:20px">ts</span><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">/* ../graphql/directives/index.ts*/</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token exports operator" style="color:rgb(127, 219, 202)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;./hasAuthorisation&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token exports operator" style="color:rgb(127, 219, 202)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;./isAuthenticated&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token exports operator" style="color:rgb(127, 219, 202)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;./upperCase&quot;</span></div></pre></div><p>📌 The code till now can be found here: <a href="https://github.com/pineapple45/custom-directives-with-express-graphql/tree/all-directive-resolvers-part-3">Link</a></p><h3 id="updating-graphql-schema-file-to-handle-custom-directives">Updating graphql-schema file to handle custom directives</h3><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627"><span class="language" style="bottom:20px">ts</span><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> buildSchema </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;graphql&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> addDirectiveResolveFunctionsToSchema </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;graphql-directive&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> upperCase</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> isAuthenticated</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> hasAuthorisation </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;../directives&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> schema </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">buildSchema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">directive *@upperCase* on FIELD_DEFINITION | FIELD</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">directive *@isAuthenticated* on FIELD_DEFINITION | FIELD</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">directive *@hasAuthorisation(roles: [Role!])* on FIELD_DEFINITION | FIELD</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">input PostInput {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    image: String</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    title: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    description: String</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    creatorId: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">type Post {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    _id: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    image: String</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    title: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    description: String</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    creator: User!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    commentList: [Comment!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    likeList: [Like!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">input CommentInput {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    text: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    postId: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    creatorId: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">type Comment {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    _id: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    text: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    post: Post!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    creator: User!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">input LikeInput {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    postId: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    creatorId: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">type Like {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    _id: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    post: Post!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    creator: User!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">enum Role {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    AUTH_USER</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    ADMIN</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    MODERATOR</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">input UserInput {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    username: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    email: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    password: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">type User {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    _id: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    username: String! @upperCase</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    email: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    password: String</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    role: Role!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    postList: [Post!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    commentList: [Comment!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    likeList: [Like!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">type AuthData {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    userId: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    token: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    tokenExpiration: Int!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">type RootQuery {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  listUsers: [User!] @hasAuthorisation(roles: [ADMIN])</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  getUserById(_id: ID!): User!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  listPosts: [Post!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  getPostById(_id: ID!): Post!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  listComments: [Comment!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  getCommentById(_id: ID!): Comment!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  listLikes: [Like!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  getLikeById(_id: ID!): Like!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  login(usernameOrEmail: String!, password: String!): AuthData!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">type RootMutation {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  createUser(user: UserInput): User</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  deleteUser(_id: ID!): String @hasAuthorisation(roles: [ADMIN])</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  createPost(post: PostInput): Post @hasAuthorisation(roles: [ADMIN])</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  deletePost(_id: ID!): String @hasAuthorisation(roles: [ADMIN,MODERATOR])</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  createComment(comment: CommentInput): Comment</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  deleteComment(_id: ID!): String @hasAuthorisation(roles: [ADMIN,MODERATOR])</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  createLike(like: LikeInput): Like</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  deleteLike(_id: ID!): String</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  assignRole(role: String! , assignedBy: ID!, assignedUser: ID!): User @hasAuthorisation(roles: [ADMIN])</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">schema {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  query: RootQuery</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  mutation: RootMutation</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">addDirectiveResolveFunctionsToSchema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  upperCase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  isAuthenticated</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  hasAuthorisation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">default</span><span class="token plain"> schema</span></div></pre></div><h3 id="updating-entry-srcindexts-file-to-pass-graphql-context-to-each-of-the-directive-resolvers">Updating entry src/index.ts file to pass graphql context to each of the directive-resolvers</h3><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627"><span class="language" style="bottom:20px">ts</span><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports operator" style="color:rgb(127, 219, 202)">*</span><span class="token imports"> </span><span class="token imports keyword" style="color:rgb(127, 219, 202)">as</span><span class="token imports"> dotenv</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;dotenv&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">dotenv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports">cors</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;cors&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports">express</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Express</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">Request</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">Response</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">NextFunction</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;express&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> graphqlHTTP </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;express-graphql&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports">schema</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;./graphql/schemas&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports">rootResolver</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;./graphql/resolvers&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports">mongoose</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;mongoose&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> app</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Express</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">express</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">use</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">cors</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">use</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">req</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> res</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> next</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token maybe-class-name">NextFunction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  res</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setHeader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;*&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  res</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setHeader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Access-Control-Allow-Methods&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;POST,GET,OPTIONS&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  res</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setHeader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Access-Control-Allow-Headers&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Content-Type, Authorization&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">method</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;OPTIONS&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">sendStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">200</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">next</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">use</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;/graphql&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">graphqlHTTP</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    schema</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> schema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    rootValue</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> rootResolver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    graphiql</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    context</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> req</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> res </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// we pass context here which will be received by aur directive resolvers</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">PORT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">NODE_ENV</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;production&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token operator" style="color:rgb(127, 219, 202)">?</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">PORT</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">PORT_DEV</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">MONGO_URI</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">MONGO_URI</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">as</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">mongoose</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">connect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token constant" style="color:rgb(130, 170, 255)">MONGO_URI</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> useNewUrlParser</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> useUnifiedTopology</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">then</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;connected to mongodb...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">listen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token constant" style="color:rgb(130, 170, 255)">PORT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)">server started on port </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">${</span><span class="token template-string interpolation constant" style="color:rgb(130, 170, 255)">PORT</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token keyword" style="color:rgb(127, 219, 202)">catch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">err </span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">err</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></pre></div><p>📌 The code till now can be found here: <a href="https://github.com/pineapple45/custom-directives-with-express-graphql/tree/full-directives-implementation-part-3">Link</a></p><p>Now let&#x27;s test our custom directives. If you take a look at the updated schema, we have our directives placed at a few different places.</p><p>As told above in the note, <em>@hasAuthorisation</em> directive also covers the logic for <em>@isAuthenticated</em> directive. We will test the <em>@hasAuthorisation</em> for both authentication and authorization.</p><p>👉 We cannot use graphiql tool for testing these directives since we need to pass headers along with our requests which we want to be either authorized or authenticated. So we will use POSTMAN tool for this purpose.The syntax for setting up queries in POSTMAN is a bit weird, So watch the video below carefully!</p><h4 id="testing-the-isauthenticated--hasauthorisation-directive">Testing the <em>@isAuthenticated</em> &amp; <em>@hasAuthorisation</em> directive</h4><p>First we will send no headers. We will try to list all users. In this case we should get <strong>you are unauthenticated</strong> error message as specified in our
<em>@hasAuthorisation</em> and <em>@isAuthenticated</em> custom-directive resolvers.</p><div class="video"><iframe src="https://www.youtube.com/embed/aE_Kgs4M2VI" title="https://www.youtube.com/embed/aE_Kgs4M2VI" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" frameBorder="0" webkitallowfullscreen="true" mozallowfullscreen="true" allowfullscreen="" width="100%" height="400"></iframe></div><p>We get <strong>you are unauthenticated</strong> which means <em>@isAuthenticated</em> directive is correctly setup. It also means that <em>@hasAuthorisation</em> directive is also correctly setup as long as authentication is concerned!</p><h4 id="testing-hasauthorisation-directive">Testing <em>@hasAuthorisation</em> directive</h4><p>Now we will take care of authorization part in <em>@hasAuthorisation</em>. First we will log in. We get the JSON Web Token. Then we use the token and send it along the header and then our custom directive resolver handles authorization. We currently have no user who is an ADMIN or MODERATOR. So as per the schema and custom directives defined in it, if we try to get a list of all users, we should get <strong>Not Authorised</strong>.</p><div class="video"><iframe src="https://www.youtube.com/embed/OQn_McPi9II" title="https://www.youtube.com/embed/OQn_McPi9II" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" frameBorder="0" webkitallowfullscreen="true" mozallowfullscreen="true" allowfullscreen="" width="100%" height="400"></iframe></div><h4 id="testing-the-uppercase-directive">Testing the <em>@upperCase</em> directive</h4><p>Now to test <em>@upperCase</em> directive, we need to get the list of all users since each username has to be shown in uppercase as per our graphql schema. User&#x27;s list can only be retrieved by an ADMIN. So I will manually update the user role of any one of the user&#x27;s in our mongodb database to ADMIN. Lets update role of <strong>john doe</strong> to ADMIN:</p><div class="video"><iframe src="https://www.youtube.com/embed/CmN-K6PW6PQ" title="https://www.youtube.com/embed/CmN-K6PW6PQ" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" frameBorder="0" webkitallowfullscreen="true" mozallowfullscreen="true" allowfullscreen="" width="100%" height="400"></iframe></div><p>Now since role of user <strong>john doe</strong> is updated to ADMIN, john should be able to retrieve the list of users successfully. We should also get usernames in uppercase which will confirm that our <em>@upperCase</em> directive is working fine:</p><div class="video"><iframe src="https://www.youtube.com/embed/ThL55acCKNs" title="https://www.youtube.com/embed/ThL55acCKNs" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" frameBorder="0" webkitallowfullscreen="true" mozallowfullscreen="true" allowfullscreen="" width="100%" height="400"></iframe></div><p>So finally we get the response that we were looking for and hence this confirms that
our custom directives are working as they should....🎉🎉🎉🎉🎉</p><h3 id="splitting-our-graphql-schemaoptional">Splitting our graphql schema(optional)</h3><p>Now our schema is getting a bit long. As the project grows, it is better to divide the schema
based on different sub-queries,sub-mutations or sub-subscriptions.
If you want to see how this is done a greater detail, watch this awesome video by ben awad: <a href="https://www.youtube.com/watch?v=4XmQi80nFes">Link</a></p><h3 id="updated-directory-structure-for-schemas-folder">Updated directory structure for schemas folder</h3><div class="gatsby-highlight" data-language=""><pre class="prism-code language-" style="color:#d6deeb;background-color:#011627"><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token plain">-src</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">--graphql</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">---schemas</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">----users.ts</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">----posts.ts</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">----comments.ts</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">----likes.ts</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">----index.ts</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">.</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">.</span></div></pre></div><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627"><span class="language" style="bottom:20px">ts</span><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">/* ../graphql/schemas/users.ts */</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> types </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">type User {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    _id: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    username: String! @upperCase</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    email: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    password: String</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    role: Role!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    postList: [Post!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    commentList: [Comment!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    likeList: [Like!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">} </span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">type AuthData {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    userId: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    token: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    tokenExpiration: Int!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">input UserInput {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    username: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    email: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    password: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> queries </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">listUsers: [User!] @hasAuthorisation(roles: [ADMIN])  </span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">getUserById(_id: ID!): User! </span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">login(usernameOrEmail: String!, password: String!): AuthData!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> mutations </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">createUser(user: UserInput): User</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  deleteUser(_id: ID!): String @hasAuthorisation(roles: [ADMIN])</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  assignRole(role: String! , assignedBy: ID!, assignedUser: ID!): User @hasAuthorisation(roles: [ADMIN])</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> subscriptions </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span></div></pre></div><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627"><span class="language" style="bottom:20px">ts</span><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">/* ../graphql/schemas/posts.ts */</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> types </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">input PostInput {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    image: String</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    title: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    description: String</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    creatorId: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">type Post {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    _id: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    image: String</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    title: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    description: String</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    creator: User!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    commentList: [Comment!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    likeList: [Like!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> queries </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">listPosts: [Post!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">getPostById(_id: ID!): Post!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> mutations </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">createPost(post: PostInput): Post @hasAuthorisation(roles: [ADMIN])</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  deletePost(_id: ID!): String @hasAuthorisation(roles: [ADMIN,MODERATOR])</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> subscriptions </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span></div></pre></div><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627"><span class="language" style="bottom:20px">ts</span><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">/* ../graphql/schemas/comments.ts */</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> types </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">input CommentInput {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    text: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    postId: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    creatorId: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">type Comment {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    _id: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    text: String!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    post: Post!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    creator: User!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> queries </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">listComments: [Comment!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">getCommentById(_id: ID!): Comment! </span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> mutations </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">createComment(comment: CommentInput): Comment</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  deleteComment(_id: ID!): String @hasAuthorisation(roles: [ADMIN,MODERATOR])</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> subscriptions </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span></div></pre></div><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627"><span class="language" style="bottom:20px">ts</span><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">/* ../graphql/schemas/likes.ts */</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> types </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">input LikeInput { </span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    postId: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    creatorId: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">type Like {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    _id: ID!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    post: Post!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    creator: User!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> queries </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  listLikes: [Like!]</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  getLikeById(_id: ID!): Like!</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> mutations </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">createLike(like: LikeInput): Like</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  deleteLike(_id: ID!): String</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> subscriptions </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span></div></pre></div><div class="gatsby-highlight" data-language="ts"><pre class="prism-code language-ts" style="color:#d6deeb;background-color:#011627"><span class="language" style="bottom:20px">ts</span><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedSecondary" tabindex="0" type="button" style="position:absolute;top:5px;right:5px;font-family:sans-serif;padding:0px;font-size:10px"><span class="MuiButton-label">copy</span></button><div class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">/* ../graphql/schemas/index.ts */</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> buildSchema </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;graphql&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> addDirectiveResolveFunctionsToSchema </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;graphql-directive&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> upperCase</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> isAuthenticated</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> hasAuthorisation </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;../directives&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// import comparted schemas</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports operator" style="color:rgb(127, 219, 202)">*</span><span class="token imports"> </span><span class="token imports keyword" style="color:rgb(127, 219, 202)">as</span><span class="token imports"> postsGQLSchema</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;./posts&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports operator" style="color:rgb(127, 219, 202)">*</span><span class="token imports"> </span><span class="token imports keyword" style="color:rgb(127, 219, 202)">as</span><span class="token imports"> commentsGQLSchema</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;./comments&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports operator" style="color:rgb(127, 219, 202)">*</span><span class="token imports"> </span><span class="token imports keyword" style="color:rgb(127, 219, 202)">as</span><span class="token imports"> likesGQLSchema</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;./likes&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports operator" style="color:rgb(127, 219, 202)">*</span><span class="token imports"> </span><span class="token imports keyword" style="color:rgb(127, 219, 202)">as</span><span class="token imports"> usersGQLSchema</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;./users&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> types</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> queries</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> mutations</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> subscriptions </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> schemas </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  postsGQLSchema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  commentsGQLSchema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  likesGQLSchema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  usersGQLSchema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">schemas</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">forEach</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">schema </span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">push</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">types</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  queries</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">push</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">queries</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  mutations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">push</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">mutations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  subscriptions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">push</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">subscriptions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> schema </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">buildSchema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">directive @upperCase on FIELD_DEFINITION | FIELD</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">directive @isAuthenticated on FIELD_DEFINITION | FIELD</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">directive @hasAuthorisation(roles: [Role!]) on FIELD_DEFINITION | FIELD</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">enum Role {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    AUTH_USER</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    ADMIN</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    MODERATOR</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">${</span><span class="token template-string interpolation">types</span><span class="token template-string interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token template-string interpolation function" style="color:rgb(130, 170, 255)">join</span><span class="token template-string interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token template-string interpolation string" style="color:rgb(173, 219, 103)">&quot;\n&quot;</span><span class="token template-string interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">type RootQuery {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">    </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">${</span><span class="token template-string interpolation">queries</span><span class="token template-string interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token template-string interpolation function" style="color:rgb(130, 170, 255)">join</span><span class="token template-string interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token template-string interpolation string" style="color:rgb(173, 219, 103)">&quot;\n&quot;</span><span class="token template-string interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">type RootMutation {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">${</span><span class="token template-string interpolation">mutations</span><span class="token template-string interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token template-string interpolation function" style="color:rgb(130, 170, 255)">join</span><span class="token template-string interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token template-string interpolation string" style="color:rgb(173, 219, 103)">&quot;\n&quot;</span><span class="token template-string interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token template-string string" style="color:rgb(173, 219, 103)"></span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="display:inline-block;color:rgb(173, 219, 103)">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">schema {</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  query: RootQuery</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">  mutation: RootMutation</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token template-string string" style="color:rgb(173, 219, 103)"></span><span class="token template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">addDirectiveResolveFunctionsToSchema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  upperCase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  isAuthenticated</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  hasAuthorisation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">default</span><span class="token plain"> schema</span></div></pre></div><p>I will leave the original schema in a reference.ts file so as to later reference in case needed.</p><p>📌 The code till now can be found here: <a href="https://github.com/pineapple45/custom-directives-with-express-graphql/tree/schema-splitting-part-3">Link</a></p><h3 id="react-app-frontend-setup">React App frontend setup</h3><p>I am using React as my frontend frameworks but you can easily use any other frontend framework such as Angular or svelte. Few other technologies that I am using on my frontend are:</p><ul><li><a href="https://www.npmjs.com/package/@apollo/client">@apollo/client</a></li><li><a href="https://www.npmjs.com/package/@material-ui/core">Material-UI</a></li><li><a href="https://www.npmjs.com/package/typescript">Typescript</a></li></ul><p>👉 Note: In the final code repository there is a client-redux folder which also consists of frontend with client graphql implementation using redux. Although , it is important to note that, functionalities such live as refetching of queries , implementaion of custom fetch and error policies is not implemented in this project.</p><p>📍 Final code: <a href="https://github.com/pineapple45/custom-directives-with-express-graphql/tree/main">Link</a></p><p>🌐 Live preview: <a href="https://pineapple45.github.io/custom-directives-with-express-graphql/">Link</a></p><h3 id="final-points">Final points</h3><p>Hope you learnt something useful from this project. In case any queries or doubts, you can comment down below and I will try to resolve them as much as I can. You can also join my <a href="https://discord.gg/cDyttEtkcJ">discord channel</a> if you want to reach out to me.</p><p><img src="https://media.giphy.com/media/3otPoS81loriI9sO8o/giphy.gif" alt="https://media.giphy.com/media/3otPoS81loriI9sO8o/giphy.gif"/></p></div><br/><h6 class="MuiTypography-root MuiTypography-body1">If you liked the content and want to contribute, you can buy me a coffee 😊</h6><br/><a href="https://www.buymeacoffee.com/pineapple45" target="_blank" rel="noreferrer"><img src="https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png" alt="Buy Me A Coffee" style="height:41px !important;width:174px !important;box-shadow:0px 3px 2px 0px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow:0px 3px 2px 0px rgba(190, 190, 190, 0.5) !important"/></a></div><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-11 MuiGrid-grid-sm-10 MuiGrid-grid-md-8"><div class="MuiBox-root jss14"><div class="MuiBox-root jss15"><a class="MuiTypography-root MuiLink-root MuiLink-underlineHover MuiTypography-colorPrimary" href="https://github.com/pineapple45"><svg xmlns="http://www.w3.org/2000/svg" focusable="false" style="padding:0 5px" width="30px" height="30px" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385c.6.105.825-.255.825-.57c0-.285-.015-1.23-.015-2.235c-3.015.555-3.795-.735-4.035-1.41c-.135-.345-.72-1.41-1.23-1.695c-.42-.225-1.02-.78-.015-.795c.945-.015 1.62.87 1.845 1.23c1.08 1.815 2.805 1.305 3.495.99c.105-.78.42-1.305.765-1.605c-2.67-.3-5.46-1.335-5.46-5.925c0-1.305.465-2.385 1.23-3.225c-.12-.3-.54-1.53.12-3.18c0 0 1.005-.315 3.3 1.23c.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23c.66 1.65.24 2.88.12 3.18c.765.84 1.23 1.905 1.23 3.225c0 4.605-2.805 5.625-5.475 5.925c.435.375.81 1.095.81 2.22c0 1.605-.015 2.895-.015 3.3c0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12z" fill="currentColor"/></g></svg></a><a class="MuiTypography-root MuiLink-root MuiLink-underlineHover MuiTypography-colorPrimary" href="https://discord.gg/cDyttEtkcJ"><svg xmlns="http://www.w3.org/2000/svg" focusable="false" style="padding:0 5px" width="30px" height="30px" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16"><g fill="currentColor"><path d="M6.552 6.712c-.456 0-.816.4-.816.888s.368.888.816.888c.456 0 .816-.4.816-.888c.008-.488-.36-.888-.816-.888zm2.92 0c-.456 0-.816.4-.816.888s.368.888.816.888c.456 0 .816-.4.816-.888s-.36-.888-.816-.888z"/><path d="M13.36 0H2.64C1.736 0 1 .736 1 1.648v10.816c0 .912.736 1.648 1.64 1.648h9.072l-.424-1.48l1.024.952l.968.896L15 16V1.648C15 .736 14.264 0 13.36 0zm-3.088 10.448s-.288-.344-.528-.648c1.048-.296 1.448-.952 1.448-.952c-.328.216-.64.368-.92.472c-.4.168-.784.28-1.16.344a5.604 5.604 0 0 1-2.072-.008a6.716 6.716 0 0 1-1.176-.344a4.688 4.688 0 0 1-.584-.272c-.024-.016-.048-.024-.072-.04c-.016-.008-.024-.016-.032-.024c-.144-.08-.224-.136-.224-.136s.384.64 1.4.944c-.24.304-.536.664-.536.664c-1.768-.056-2.44-1.216-2.44-1.216c0-2.576 1.152-4.664 1.152-4.664c1.152-.864 2.248-.84 2.248-.84l.08.096c-1.44.416-2.104 1.048-2.104 1.048s.176-.096.472-.232c.856-.376 1.536-.48 1.816-.504c.048-.008.088-.016.136-.016a6.521 6.521 0 0 1 4.024.752s-.632-.6-1.992-1.016l.112-.128s1.096-.024 2.248.84c0 0 1.152 2.088 1.152 4.664c0 0-.68 1.16-2.448 1.216z"/></g></svg></a><a class="MuiTypography-root MuiLink-root MuiLink-underlineHover MuiTypography-colorPrimary" href="https://twitter.com/Anmol_gomra"><svg xmlns="http://www.w3.org/2000/svg" focusable="false" style="padding:0 5px" width="30px" height="30px" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16"><g fill="currentColor"><path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334c0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518a3.301 3.301 0 0 0 1.447-1.817a6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429a3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218a3.203 3.203 0 0 1-.865.115a3.23 3.23 0 0 1-.614-.057a3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"/></g></svg> </a></div><br/><p class="MuiTypography-root MuiTypography-subtitle1">© Copyright ShadedVoxels 2021</p></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/custom-directives-with-express-graphql-part-3";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-3406944e0f754c9e2a9c.js"],"app":["/app-4e1f042b2ddf33033244.js"],"component---src-pages-404-js":["/component---src-pages-404-js-f28b69afa4be4419e6da.js"],"component---src-pages-about-js":["/component---src-pages-about-js-af827b141801d087c7b3.js"],"component---src-pages-projects-js":["/component---src-pages-projects-js-7a89fc2fb19d8292ce8a.js"],"component---src-templates-all-posts-js":["/component---src-templates-all-posts-js-3ab2190da82928984448.js"],"component---src-templates-single-post-js":["/component---src-templates-single-post-js-b1a90b0d8e8cbfe3f272.js"]};/*]]>*/</script><script src="/polyfill-3406944e0f754c9e2a9c.js" nomodule=""></script><script src="/component---src-templates-single-post-js-b1a90b0d8e8cbfe3f272.js" async=""></script><script src="/0684c67b9e8324955648f07f379967749028407c-e3e25b0e30fb34667ff0.js" async=""></script><script src="/72f02af15790646481057260ef855e91d01147d0-96b483a23b69f0de04e6.js" async=""></script><script src="/commons-be761d1874bc4e647fc8.js" async=""></script><script src="/app-4e1f042b2ddf33033244.js" async=""></script><script src="/framework-8b3c321ae27fc20a6b24.js" async=""></script><script src="/webpack-runtime-7db009d6acd8d3eb2c1f.js" async=""></script></body></html>